subroutine vector_fun(x, f) bind (C, name = "vector_fun")
   use iso_c_binding, only: C_DOUBLE

   real(kind = C_DOUBLE), intent(inout) :: f(5)
   real(kind = C_DOUBLE), intent(in) :: x(5)

   real(kind = C_DOUBLE), parameter :: a(5, 5) = reshape(&
      [ 0.412955953377646, 0.074033076338822, 0.045372211178409, -0.004667464883872, -0.037693776011006, &
         0.074033076338822, 0.334173152538700, 0.073600194475449, 0.027481181411050, -0.015954271430687, &
         0.045372211178409, 0.073600194475449, 0.264511984040490, 0.055353270445701, 0.057829006526616, &
         -0.004667464883872, 0.027481181411050, 0.055353270445701, 0.325519774410938, 0.096313238616184, &
         -0.037693776011006, -0.015954271430687, 0.057829006526616, 0.096313238616184, 0.402839135632226], &
      shape(a))

   f = matmul(a, x)

   f = f / norm2(f)
end subroutine vector_fun